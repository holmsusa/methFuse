clust4 <- cutree(clust, k = 4)
plot(color_branches(dend = as.dendrogram(clust), clusters = clust4, col = colors))
color_branches(dend = as.dendrogram(clust), clusters = clust4, col = colors)
clust4
plot(color_branches(dend = as.dendrogram(clust), clusters = clust4, col = colors), xlab = "")
library(datasets)   # For the iris dataset
library(dendextend) # For coloring the dendrogram
# Load the iris dataset
data(iris)
# Use only the Sepal.Length variable
sepal_length <- iris$Sepal.Length
# Perform hierarchical clustering (method = "complete" is used here, but you can choose others like "ward.D", "average")
hc <- hclust(dist(sepal_length), method = "complete")
# Cut the dendrogram into 4 clusters
clusters <- cutree(hc, k = 4)
# Create a dendrogram object
dend <- as.dendrogram(hc)
# Assign colors to clusters
dend_colored <- color_branches(dend, k = 4)
# Plot the dendrogram with the colors
plot(dend_colored, main = "Dendrogram of Iris Sepal.Length", ylab = "Height")
# Optionally, add labels based on clusters
dend_colored <- dendextend::set(dend_colored, "labels_col", value = clusters)
# Plot again with cluster labels
plot(dend_colored, main = "Dendrogram of Iris Sepal.Length with Cluster Colors", ylab = "Height")
# Plot again with cluster labels
plot(dend_colored, xlab = "")
labels(dend_colored) <- rep("", length(labels(dend_colored)))
# Plot again with cluster labels
plot(dend_colored, xlab = "")
version()
version
#_________ FUNCTION TO SHAPE INPUT ______________-#
create_input <- function(mutations, cn) {
# Remove chromosomes Y and M
invalid <- grep("chrM|chrY", mutations$CHROM)
if(length(invalid) > 0) {  mutations <- mutations[-invalid, ]}
# Extracting sample list from colnames
samps <- sub("\\.AD$", "", colnames(mutations)[grep("\\.AD$", colnames(mutations))])
# Result dataframe
res <- c()
# Iterating trough samples
for(samp in samps) {
# Including cns only for this sample
cn_set <- cn[grep(samp, cn$sample), ]
# Ref and alt counts
counts <- mutations[, grep(paste(samp, "AD", sep = "."), colnames(mutations))]
counts <- as.numeric(unlist(lapply(counts, function(X) strsplit(X, ","))))
ref_counts = counts[seq(1,length(counts), 2)]
alt_counts = counts[seq(2,length(counts), 2)]
# Copy numbers
pos <- data.frame(chr = mutations$CHR, pos = mutations$POS)
CHR <- paste("chr", c(seq(1,22), "X"), sep = "")
cn_Major <- c()
cn_Minor <- c()
no_cn <- c()
for (chr in CHR) {
# For each pos: check the current range. If not in that one, go forward.
pos_chr <- pos[pos$chr == chr, ]
cn_chr <- cn_set[cn_set$chr == chr,]
# Only proceed if pos_chr and cn_chr are not empty!
if(nrow(pos_chr) > 0 && nrow(cn_chr) > 0) {
id <- 1
for (i in 1:nrow(pos_chr)) {
# When mutations are out of the current cn range, increase cn id
if( (id < nrow(cn_chr)) && (pos_chr$pos[i] > cn_chr$endpos[id]) ) {
id <- id+1
}
# Store cn information for mutation i
if((id <= nrow(cn_chr)) && ( (pos_chr$pos[i] > cn_chr$startpos[id]) && (pos_chr$pos[i] < cn_chr$endpos[id]))) {
# Store when mutations lie within cn range
cn_Major <- c(cn_Major, cn_chr$nMajor[id])
cn_Minor <- c(cn_Minor, cn_chr$nMinor[id])
} else {
cn_Major <- c(cn_Major, NA)
cn_Minor <- c(cn_Minor, NA)
}
}
}
}
data <- data.frame(mutation_id = paste(mutations$CHROM, ":", mutations$POS, ":", mutations$REF, ">", mutations$ALT, sep = ""),
sample_id = samp,
ref_counts = ref_counts,
alt_counts = alt_counts, # From AD
major_cn = cn_Major,
minor_cn = cn_Minor,
normal_cn = 2,
tumour_content = 1) # From ascat output, 1 for organoids
res <- rbind(res, data)
}
# Remove NaNs
# res <- res[-which(is.na(res$major_cn)), ]
return(res)
}
setwd("~/Documents/storageBig8/work/holmsusa/evolution")
## Check how many mutations left in WES regions
files <- (Sys.glob("../../../web-pub/projects/HERCULES/WGS/variants_allMatched/variants_v4.8/byPatient_CSVs/*.csv"))
files
sub("^.*byPatient_CSVs\\/", "", files)
sub("\\.csv$", "", sub("^.*byPatient_CSVs\\/", "", files
))
file <- files[1]
WGS_mut <- read.table(file, header = T)
nrow(WGS_mut)
head(WGS_mut)
res <- data.frame("patient" = sub("\\.csv$", "", sub("^.*byPatient_CSVs\\/", "", files)),
"WGS" = 0,
"WES" = 0)
# Filter mutations
only_exome <- function(mutations_WGS, exome) {
mutations_exome <- NULL
CHR <- paste("chr", c(1:22, "X"), sep = "")
for(chr in CHR) {
# Sets of mutations and exome only within current chromosome
mut_set <- mutations_WGS[mutations_WGS$CHROM == chr, ]
ex_set <- exome[exome$V1 == chr, ]
# Id for mutations row
id <- 1
# Iterating over rows in exome set
for( i in 1:nrow(ex_set)) {
# Include all mutations within certain exon
while(id <= nrow(mut_set) && mut_set$POS[id] > ex_set[i, 2] && mut_set$POS[id] < ex_set[i, 3]) {
mutations_exome <- rbind(mutations_exome, mut_set[id, ])
id <- id + 1
}
}
}
}
WES_mut <- only_exome(WGS_mut, exome)
exome <- as.data.frame(read.table("../../micoli/tumor_evolution/CNV_WES_calling/resources/exonic_intervals.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE, quote=""))
WES_mut <- only_exome(WGS_mut, exome)
head(WES_mut)
WGS_mut[, 1:5]
WGS_mut[, 1:3]
WGS_mut[, 1:2]
exome
res$WES <- nrow(WES_mut)
res
res[1, ]
res <- data.frame("patient" = sub("\\.csv$", "", sub("^.*byPatient_CSVs\\/", "", files)),
"WGS" = 0,
"WES" = 0)
res[1, ]
res$WGS <- nrow(WGS_mut)
res$WES <- nrow(WES_mut)
res[1, ]
WES_mut
nrow(WES_mut)
is.null(WES_mut)
res <- data.frame("patient" = sub("\\.csv$", "", sub("^.*byPatient_CSVs\\/", "", files)),
"WGS" = 0,
"WES" = 0)
for(file in files) {
WGS_mut <- read.table(file, header = T)
res$WGS <- nrow(WGS_mut)
WES_mut <- only_exome(WGS_mut, exome)
res$WES <- ifelse(is.null(WES_mut), 0, nrow(WES_mut))
}
res
for(i in 1:length(files)) {
WGS_mut <- read.table(files[i], header = T)
res$WGS[i] <- nrow(WGS_mut)
WES_mut <- only_exome(WGS_mut, exome)
res$WES[i] <- ifelse(is.null(WES_mut), 0, nrow(WES_mut))
print(res[i, ])
}
mutations_WGS <- WGS_mut
# Sets of mutations and exome only within current chromosome
mut_set <- mutations_WGS[mutations_WGS$CHROM == chr, ]
chr <- "chr1"
# Sets of mutations and exome only within current chromosome
mut_set <- mutations_WGS[mutations_WGS$CHROM == chr, ]
mut_set
ex_set <- exome[exome$V1 == chr, ]
ex_set
dim(mut_set)
dim(ex_set)
# Id for mutations row
id <- 1
mut_set[1]
mut_set[1, ]
mut_set[1, 2]
head(ex_set)
head(mut_set[,1])
head(mut_set[,2])
mut_set[,2]
samples <- read.table("./Documents/storageBig8/work/holmsusa/methylation/data/headers.csv", header = T)
samples <- read.table("./Documents/storageBig8/work/holmsusa/methylation/data/headers.csv", header = T)
samples <- read.table("./Documents/storageBig8/work/holmsusa/methylation/data/headers.csv", header = T)
samples$patient <- sub("\\_.*$", "", samples$x)
samples$phase <- sub("[1-9]{0,1}[A-Z][a-z]{2}.*$", "", sub("^(OC|[H|D])[0-9]{3}\\_", "", samples$x))
samples$tissue <- sub("[1-9]{0,1}\\_.*$", "", sub("^.*\\_[1-9]{0,1}[p|i|r][1-9]{0,1}", "", samples$x))
samples <- samples[1:67, ]
samples$tissue_type <- "Metastatic"
samples$tissue_type[samples$tissue %in% c("Ova", "OvaL", "OvaR", "TubR", "Adn")] <- "Adnexa"
samples$tissue_type[samples$tissue == "Asc"] <- "Ascites"
table(samples$tissue_type)
tab <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.csv", header = T)
tab <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.csv", header = T, fill = "")
tab <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.csv", header = T, fill = T)
head(tab)
dim(tab)
tab[1:3, 1:3]
tab <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.csv", header = F, fill = T)
tab[1:3, 1:3]
tab <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.csv", header = T, fill = T, sep = ",")
head(tab)
write.table(tab, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv")
is.null(tab[3,3])
tab[3,3]
length(tab[3,3])
tab[3,3] == ""
tab[which(tab == "", arr.ind = T)] <- NA
head(tab)
tab[1, 4]
is.na(tab[1, 4])
class(tab[1,4])
class(tab[3,3])
tab[which(is.na(tab), arr.ind = T)] <- NA
head(tab)
tab[which(is.na(tab), arr.ind = T)] <- NA_integer_
head(tab)
class(tab[1,4])
tab[1,4]
write.table(tab, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv")
write.table(tab, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", quote = F)
write.table(tab, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", quote = F, sep = "\t", row.names = F)
head(tab)
tab$ovcabase.ID[which(is.na(tab$ovcabase.ID))] <- NA_integer_
tab$ovcabace.cell.line.ID[which(is.na(tab$ovcabace.cell.line.ID))] <- NA_integer_
tab$Contamination[which(is.na(tab$Contamination))] <- FALSE
tab$GC.content.issue[which(is.na(tab$GC.content.issue))] <- FALSE
tab$Cell.line[which(is.na(tab$Cell.line))] <- FALSE
head(tab)
write.table(tab, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", quote = F, sep = "\t", row.names = F)
tab$ovcabace.cell.line.ID[which(is.na(tab$ovcabace.cell.line.ID))] <- NA
tab$ovcabase.ID[which(is.na(tab$ovcabase.ID))] <- NA
head(tab)
class(tab$ovcabace.cell.line.ID)
class(tab$ovcabase.ID)
write.table(tab, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", quote = F, sep = "\t", row.names = F)
setwd("~/Documents/storageBig8/work/holmsusa/evolution/mimic_WES")
#### Arguments passed by user ####
library("optparse")
option_list = list(
make_option(c("-m", "--mutations"), type="character", default="../../../../web-pub/projects/HERCULES/WGS/variants_allMatched/variants_v4.8/byPatient_CSVs/",
help="Path to directory of mutation files. [default = %default]", metavar="character"),
make_option(c("-c", "--copynumbers"), type="character", default="../../../../web-pub/projects/HERCULES/WGS/copyNumber_allMatched/v2.7b2/combinedAscatSegments-out.csv",
help="Path to cn file. [default = %default]", metavar="character"),
make_option(c("-e", "--exome"), type = "character", default="exome_regions.csv",
help="Path to bed-file with exome regions. [default = %default]", metavar="character"),
make_option(c("-o", "--output"), type = "character", default="data_WGS/",
help="Path to output directory. [default = %default]", metavar="character"),
make_option(c("-r", "--regions"), type = "character", default="WGS",
help="Either WGS or WES. [default = %default]", metavar="character"),
make_option(c("-v", "--verbose"), type="logical", default=F,
help="Print verbose. [default = %default]", metavar="logical")
);
opt_parser = OptionParser(option_list=option_list);
opt = parse_args(opt_parser);
##### Source functions #####
source("./helper_functions.R")
# List of input files to iterate trough
mutation_files <- list.files(opt$mutations)
mutation_files
tab <- read.table("../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/effCountsG-joined-out.csv", header = T)
excluded <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/excluded_samples.tsv")
excluded
names(tab)
names(tab) %in% excluded
names(tab) %in% excluded$x
names(tab) %in% excluded$V1
names(tab)[-names(tab) %in% excluded]
names(tab)[-which(names(tab) %in% excluded$V1)]
dim(tab)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
dim(tab)
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/effCountsG-joined-out.csv", sep = "/t", row.names = F)
tab <- read.table("../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/effCountsT-joined-out.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/effCountsT-joined-out.csv", sep = "/t", row.names = F)
tab <- read.table("../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/exprTable-log2-table.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/exprTable-log2-table.csv", sep = "/t", row.names = F)
tab <- read.table("../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/exprTableG-log2-table.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/exprTableG-log2-table.csv", sep = "/t", row.names = F)
tab <- read.table("../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/length-joined-out.csv", header = T)
head(tab)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/length-joined-out.csv", sep = "/t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/effCountsG-joined/out.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/length-joined-out.csv", sep = "\t", row.names = F)
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/effCountsG-joined-out.csv", sep = "\t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/effCountsT-joined/out.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/effCountsT-joined-out.csv", sep = "\t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/exprTable-log2/table.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/exprTable-log2-table.csv", sep = "\t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/exprTableG-log2/table.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/exprTableG-log2-table.csv", sep = "\t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/length-joined/out.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/length-joined-out.csv", sep = "\t", row.names = F)
excluded <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/excluded_samples.tsv")
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/effCountsG-joined/out.csv", header = T)
dim(tab)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
dim(tab)
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/effCountsG-joined-out.csv", sep = "\t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/effCountsT-joined/out.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/effCountsT-joined-out.csv", sep = "\t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/exprTable-log2/table.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/exprTable-log2-table.csv", sep = "\t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/exprTableG-log2/table.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/exprTableG-log2-table.csv", sep = "\t", row.names = F)
tab <- read.table("../../../afenteva/OVCA_RNASEQ_set18_analysis/result_expression/length-joined/out.csv", header = T)
tab <- tab[, -which(names(tab) %in% excluded$V1)]
write.table(tab, "../../../../resources/processed_data/HERCULES/bulk_RNAseq/expression_tables/set18/length-joined-out.csv", sep = "\t", row.names = F)
old <- read.table("/home/local/holmsusa/Documents/storageBig8/work/holmsusa/rna_preprocessing/OVCA_RNASeq_set18_analysis/props1-17.csv", header = T)
old <- read.table("/home/local/holmsusa/Documents/storageBig8/work/holmsusa/rna_preprocessing/OVCA_RNASeq_set18_analysis/props1-17.csv", header = T, row.names = NULL)
old
new <- read.table("/home/local/holmsusa/Documents/storageBig8/work/holmsusa/rna_preprocessing/OVCA_RNASeq_set18_analysis/props1-18.csv", header = T, row.names = NULL)
plot(old$EOC)
hist(old$EOC)
hist(new$EOC)
new
summary(new$EOC)
summary(old$EOC)
old_expr <- read.table(gzfile("/home/holmsusa/Documents/storageBig8/resources/processed_data/HERCULES/rnaseq-decom/2024_04_29/in/bulk_expr.tsv.gz"), header = T)
new_expr <- read.table(gzfile("/home/holmsusa/Documents/storageBig8/resources/processed_data/HERCULES/rnaseq-decom/2024_10_04_CLEAN/in/bulk_expr.tsv.gz"), header = T)
head(old_expr)
old_expr[1:5, 1:5]
new_expr[1:5, 1:5]
old[1:5, 1126:1131]
old_expr[1:5, 1126:1131]
names(new_expr)[1:5]
new_expr[1:5, names(new_expr)[1:5]]
old_expr[1:5, names(new_expr)[1:5]]
even_older_expr <- old_expr <- read.table(gzfile("/home/holmsusa/Documents/storageBig8/resources/processed_data/HERCULES/rnaseq-decom/2023_03_10/in/bulk_expr.tsv.gz"), header = T)
even_older_expr <- read.table(gzfile("/home/holmsusa/Documents/storageBig8/resources/processed_data/HERCULES/rnaseq-decom/2023_03_10/in/bulk_expr.tsv.gz"), header = T)
even_older_expr[1:5, names(new_expr)[1:5]]
intersect(names(old_expr), names(even_older_expr))
identical(old_expr[, intersect(names(old_expr), names(even_older_expr))], even_older_expr[, intersect(names(old_expr), names(even_older_expr))])
identical(old_expr[1:5, intersect(names(old_expr), names(even_older_expr))], even_older_expr[1:5, intersect(names(old_expr), names(even_older_expr))])
old_expr[1:5, intersect(names(old_expr), names(even_older_expr))]
old_expr[1:5, 1:5]
even_older_expr[1:5, 1:5]
names(old_expr)[1:5]
new_expr[1:5, names(old_expr)[1:5]]
old_expr[1:10, 1:15]
old_expr[1:10, 1:12]
even_older_expr[1:10, 1:12]
new_expr[1:5, names(old_expr)[1:12]]
new_expr[1:10, names(old_expr)[1:12]]
old_expr[1:10, 1:12]
even_older_expr[1:10, 1:12]
new_expr <- read.table(gzfile("/home/local/holmsusa/Documents/storageBig8/work/afenteva/RNASEQ/CLEAN_DATA/EOC.tsv.gz"), header = T)
new_expr[1:5, 1:5]
new_expr[1:10, names(old_expr)[1:12]]
old_expr[1:10, 1:12]
even_older_expr[1:10, 1:12]
new_expr <- read.table(gzfile("/home/local/holmsusa/Documents/storageBig8/work/afenteva/RNASEQ/CLEAN_DATA/bulk.tsv.gz"), header = T)
new_expr[1:10, names(old_expr)[1:12]]
tab <- read.table("/home/local/holmsusa/Documents/storageBig8/work/holmsusa/methylation/downstream/correlation/rna_correlation/giant/output/signif_cor_per_gene_all.tsv", header = T)
head(tab)
tab[1:2, 1:5]
tab[1:2, 1:2]
tab[1, 1:5]
tab[1:5, 1]
tab[1:5, 1:2]
names(tab)
tab[1:5, c(1,4)]
write.table(tab, file = "/home/local/holmsusa/Documents/storageBig8/work/holmsusa/methylation/downstream/correlation/rna_correlation/giant/output/signif_cor_per_gene_all.tsv", header = T, row.names = F)
write.table(tab, file = "/home/local/holmsusa/Documents/storageBig8/work/holmsusa/methylation/downstream/correlation/rna_correlation/giant/output/signif_cor_per_gene_all.tsv", sep = "\Ã¾", row.names = F)
write.table(tab, file = "/home/local/holmsusa/Documents/storageBig8/work/holmsusa/methylation/downstream/correlation/rna_correlation/giant/output/signif_cor_per_gene_all.tsv", sep = "\t", row.names = F)
tab <- read.table("/home/local/holmsusa/Documents/storageBig8/work/holmsusa/methylation/downstream/correlation/rna_correlation/giant/output/signif_cor_per_segment_all.tsv", header = T)
tab[1:5, c(1,4)]
dim(tab)
tab[1:5, ]
names(tab)
tab[1:5, c(1,3)]
tab[1:5, 3]
write.table(tab, file = "/home/local/holmsusa/Documents/storageBig8/work/holmsusa/methylation/downstream/correlation/rna_correlation/giant/output/signif_cor_per_segment_all.tsv", sep = "\t", row.names = F)
write.table(tab, file = "/home/local/holmsusa/Documents/storageBig8/work/holmsusa/methylation/downstream/correlation/rna_correlation/giant/output/signif_cor_per_segment_all.tsv", sep = "\t", row.names = T, col.names = T)
rna_names <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", header = T, fill = "")
rna_names <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", header = T)
source("~/.active-rstudio-document", echo=TRUE)
rna_names <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", header = T, quote = "")
rna_names <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", header = T, fill = T)
head(rna_names)
rna_names[which(rna_names$Sample.name.unique == "H284_pOvaR1_RNA1")]
rna_names[which(rna_names$Sample.name.unique == "H284_pOvaR1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H284_pOvaR1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "H284_pOvaR1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H299_pAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H299_pAsc1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "H299_pAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D353_iAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D353_iAsc1_RNA1"), "Usable"] < -F
rna_names[which(rna_names$Sample.name.unique == "D353_iAsc1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "D353_iAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D353_pAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D353_pAsc1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "D353_pAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D417_pAdnR1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D417_pAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H043_pPer3_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H024_pOvaL7_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H024_pOvaL7_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "H024_pOvaL7_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H116_pPer2_RNA1_Data1"), ]
rna_names[which(rna_names$Sample.name.unique == "H235_r2Asc_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H235_r2Asc_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "H043_pPer3_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H240_pOme1_TR_RNA2_Data1"), ]
rna_names[which(rna_names$Sample.name.unique == "H240_rOth1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H240_rOth1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "H240_rOth1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H264_p2OvaR1_RNA1"), ]
rna_names <- read.table("./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", header = T, fill = T)
rna_names[which(rna_names$Sample.name.unique == "H284_pOvaR1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H284_pOvaR1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "H299_pAsc1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "H299_pAsc1_RNA1"), "Usable"]
rna_names[which(rna_names$Sample.name.unique == "H299_pAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D353_iAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D353_iAsc1_RNA1"), "Usable"] <- FALSE
rna_names[which(rna_names$Sample.name.unique == "D353_pAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D353_pAsc1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "D417_pAdnR1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "D417_pAsc1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H043_pPer3_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H024_pOvaL7_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H024_pOvaL7_RNA1"), "Usable"]<- F
rna_names[which(rna_names$Sample.name.unique == "H116_pPer2_RNA1_Data1"), ]
rna_names[which(rna_names$Sample.name.unique == "H235_r2Asc_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H043_pPer3_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H240_pOme1_TR_RNA2_Data1"), ]
rna_names[which(rna_names$Sample.name.unique == "H240_rOth1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H264_p2OvaR1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H271_pOvaR1_RNA2"), ]
rna_names[which(rna_names$Sample.name.unique == "H271_pPer1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "H299_iOme1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "OC037_pPer1_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "OC037_pPer1_RNA1"), "Usable"] <- F
rna_names[which(rna_names$Sample.name.unique == "OC038_pPer_RNA1"), ]
rna_names[which(rna_names$Sample.name.unique == "OC037_pPer1_RNA1"), "Usable"] <- T
rna_names[which(rna_names$Sample.name.unique == "OC038_pPer_RNA1_Data1"), ]
table(rna_names)
table(rna_names$GC.content.issue)
table(rna_names$Contamination)
rna_names$Contamination[which(rna_names$Contamination == "wrong") ] <- "wrong name"
table(rna_names$Contamination)
table(rna_names$GC.content.issue)
rna_names[which(rna_names$GC.content.issue == "name"), ]
rna_names$GC.content.issue[which(which(rna_names$GC.content.issue == "name")), "GC.content.issue"] <- F
rna_names$GC.content.issue[which(rna_names$GC.content.issue == "name")] <- F
rna_names[which(rna_names$GC.content.issue == "name"), ]
rna_names[c(126, 352, 456, 468, 568, 578, 983, 985, 1007, 1010, 1040, 1042), ]
rna_names[c(126, 352, 465, 468, 568, 578, 983, 985, 1007, 1010, 1040, 1042), ]
rna_names$Fastq.name[c(126, 352, 465, 468, 568, 578, 983, 985, 1007, 1010, 1040, 1042)] <- rna_names$Fastq.path[c(126, 352, 465, 468, 568, 578, 983, 985, 1007, 1010, 1040, 1042)]
rna_names$Fastq.path[c(126, 352, 465, 468, 568, 578, 983, 985, 1007, 1010, 1040, 1042)] <- NA
rna_names[c(126, 352, 456, 468, 568, 578, 983, 985, 1007, 1010, 1040, 1042), ]
rna_names[c(126, 352, 465, 468, 568, 578, 983, 985, 1007, 1010, 1040, 1042), ]
head(rna_names)
write.table(rna_name, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", sep = "\t", row.names = F)
write.table(rna_names, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names.tsv", sep = "\t", row.names = F)
write.table(rna_names, file = "./Documents/storageBig8/resources/processed_data/HERCULES/bulk_RNAseq/RNA_names_20241011.tsv", sep = "\t", row.names = F)
head(tab)
rna_names$Sample.name.unique
setwd("~/Documents/storageBig8/work/holmsusa/fuseR/R")
cd ..
setwd("~/Documents/storageBig8/work/holmsusa/fuseR")
devtoold::document()
devtools::document()
devtools::document()
.Last.error
document()
devtools::document()
devtools::document()
evtools::document()
devtools::document()
devtools::clean_dll()
devtools::document()
devtools::clean_dll()  # Clear any prior DLL files
devtools::document()
devtools::install()
devtools::clean_dll()  # Clear any prior DLL files
devtools::document()
devtools::install()
devtools::document()
devtools::install()
library("fuseR")
k0 <- matrix(1:9, nrow = 3)
k0
k1 <- k0+k0
k1
island.cluster(k0, k1)
tree <- island.cluster(k0, k1)
tree <- island.sort.tree(tree)
?island.cluster
devtools::document()
# or
roxygen2::roxygenise()
devtools::install()
