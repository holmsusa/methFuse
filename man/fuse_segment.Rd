% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/segment.R
\name{fuse_segment}
\alias{fuse_segment}
\title{Full FUSE Segmentation Pipeline}
\usage{
fuse_segment(K0, K1, chr, pos, method = c("BIC", "AIC"), sort = TRUE)
}
\arguments{
\item{K0}{Integer or numeric matrix of unmethylated counts.}

\item{K1}{Integer or numeric matrix of methylated counts.}

\item{chr}{Character vector giving chromosome for each CpG site.}

\item{pos}{Numeric vector of genomic coordinates for each CpG site.}

\item{method}{Information criterion to use for determining optimal clusters.
One of \code{"BIC"} or \code{"AIC"}. Defaults to \code{"BIC"}.}

\item{sort}{Logical; whether to sort the clustering tree optimally. Defaults to TRUE.}
}
\value{
A list with two elements (the same structure as \code{\link{fuse.summary}}):
\describe{
\item{summary}{A data frame summarizing segments (chromosome, start/end, CpG count, etc.)}
\item{betas_per_segment}{Matrix of per-segment methylation estimates.}
}
}
\description{
Performs the full FUSE segmentation workflow, from hierarchical clustering
to automatic determination of the optimal number of clusters and summarization
of segmentation results.

This function combines the steps:
\enumerate{
\item Hierarchical clustering via \code{\link{fuse.cluster}}
\item Optimal number of segments determination via \code{\link{number.of.clusters}}
\item Cutting the tree into clusters via \code{\link{fuse.cut.tree}}
\item Summarizing the segmentation via \code{\link{fuse.summary}}
}
}
\examples{
\donttest{
K0 <- matrix(sample(1:200, 125, replace = TRUE), ncol = 5)
K1 <- matrix(sample(1:200, 125, replace = TRUE), ncol = 5)
chr <- rep("chr1", nrow(K0))
pos <- 1:nrow(K0)

res <- fuse_segment(K0, K1, chr, pos, method = "BIC")
head(res$summary)
}

}
