% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/summary.R
\name{fuse.summary}
\alias{fuse.summary}
\title{Summarize FUSE Segmentation Results}
\usage{
fuse.summary(K0, K1, chr, pos, segments)
}
\arguments{
\item{K0}{Integer or numeric matrix of unmethylated counts.}

\item{K1}{Integer or numeric matrix of methylated counts.}

\item{chr}{Character vector giving the chromosome for each site.}

\item{pos}{Numeric vector giving genomic coordinates for each site.}

\item{segments}{Integer vector giving segment IDs for each site in K0 and K1.}
}
\value{
A list with two elements:
\describe{
\item{summary}{A data frame with one row per segment and columns:}
\describe{
\item{Segment}{Segment ID}
\item{Chr}{Chromosome}
\item{Start}{Start genomic coordinate}
\item{End}{End genomic coordinate}
\item{CpGs}{Number of CpGs in the segment}
\item{Length}{Genomic length (End - Start + 1)}
\item{Beta}{Average methylation across samples and CpGs}
\item{Stable}{Logical indicator (TRUE if segment is stable, else FALSE)}
}
\item{betas_per_segment}{Matrix of per-sample methylation estimates for each segment
(rows = segments, columns = samples).}
}
}
\description{
Summarizes FUSE segmentation results into one row per segment,
including genomic coordinates, CpG count, segment length, average
methylation (beta), and stability flag based on likelihood testing.
Also returns per-sample methylation estimates for each segment.
}
\examples{
set.seed(1234)
K0 <- matrix(
  rep(c(sample(0:20, 200, replace = TRUE), sample(20:40, 200, replace = TRUE)), 2),
  nrow = 100, byrow = TRUE
)
K1 <- matrix(
  rep(c(sample(20:40, 200, replace = TRUE), sample(0:20, 200, replace = TRUE)), 2),
  nrow = 100, byrow = TRUE
)
tree <- fuse.cluster(K0, K1)
segments <- fuse.cut.tree(tree, 4)
res <- fuse.summary(K0, K1, rep("chr1", nrow(K0)), 1:nrow(K0), segments)
head(res$summary)
head(res$betas_per_segment)

}
