<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example workflow using FUSE • fuseR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example workflow using FUSE">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fuseR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/example.html">Example workflow</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example workflow using FUSE</h1>
                        <h4 data-toc-skip class="author">Susanna
Holmstrom</h4>
            
            <h4 data-toc-skip class="date">2025-11-20</h4>
      

      <div class="d-none name"><code>example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://holmsusa.github.io/fuseR/">fuseR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="reading-in-data">Reading in data<a class="anchor" aria-label="anchor" href="#reading-in-data"></a>
</h3>
<p>We start by reading in the data, which consist of the tables K0 and
K1. Both have CpG sites as rows and samples as columns, and</p>
<ul>
<li>K0 contains the unmethylated counts</li>
<li>K1 contains the methylated counts</li>
</ul>
<p>This is a dummy data set consisting of manipulated counts of the 100
000 first CpG sites in chromosome 20.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k0_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/k0.tsv.gz"</span>, package <span class="op">=</span> <span class="st">"fuseR"</span><span class="op">)</span></span>
<span><span class="va">k1_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/k1.tsv.gz"</span>, package <span class="op">=</span> <span class="st">"fuseR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">K0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">k0_file</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">K1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">k1_file</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             Sample1 Sample2 Sample3 Sample4 Sample5 Sample6 Sample7 Sample8</span></span>
<span><span class="co">## chr20.60008       0       6       0       0       0       0       0       0</span></span>
<span><span class="co">## chr20.60009       0       0       9       0      17       0      17       0</span></span>
<span><span class="co">## chr20.60119      21       0       0      22       0      21       0       3</span></span>
<span><span class="co">## chr20.60120      17       0       0      21      16      19       0       0</span></span>
<span><span class="co">## chr20.60578       0      16       0       8       5       0       0      19</span></span>
<span><span class="co">## chr20.60579       0      13      17       0      10       0       0      11</span></span>
<span><span class="co">##             Sample9 Sample10 Sample11 Sample12 Sample13 Sample14 Sample15</span></span>
<span><span class="co">## chr20.60008       0       17       18        0        7        0        0</span></span>
<span><span class="co">## chr20.60009      17        7        1       19        3       16        0</span></span>
<span><span class="co">## chr20.60119       0       21        6        0        0       17       16</span></span>
<span><span class="co">## chr20.60120       0        0       19        0        0        0       11</span></span>
<span><span class="co">## chr20.60578       0        4        0        4       15        0        0</span></span>
<span><span class="co">## chr20.60579       0        2       20        0        0       16        6</span></span>
<span><span class="co">##             Sample16 Sample17 Sample18 Sample19 Sample20</span></span>
<span><span class="co">## chr20.60008       17       13       17       21        0</span></span>
<span><span class="co">## chr20.60009       16       10        0       16        0</span></span>
<span><span class="co">## chr20.60119        3        2       15        9        0</span></span>
<span><span class="co">## chr20.60120        0        0        5       18        0</span></span>
<span><span class="co">## chr20.60578       19        0        0       22        0</span></span>
<span><span class="co">## chr20.60579        0        2        0        0        9</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="apply-fuse-as-a-pipeline">Apply FUSE as a pipeline<a class="anchor" aria-label="anchor" href="#apply-fuse-as-a-pipeline"></a>
</h3>
<p>The whole FUSE pipeline can be applied using the function
‘fuse.segment()’. It performs the following steps:</p>
<ol style="list-style-type: decimal">
<li>clustering</li>
<li>cutting clustering tree optimally</li>
<li>summarizing segments</li>
</ol>
<p>The function takes as input the count matrices K0 and K1 and the
chromosome and position information for each CpG site, and outputs a
summary table and a data frame with betas.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">segment_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fuse.segment.html">fuse.segment</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">K1</span><span class="op">)</span>, </span>
<span>  chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\..*$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.*\\."</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">segment_result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       Segment   Chr Start   End CpGs Length      Beta Coherent</span></span>
<span><span class="co">## 1 chr20.60008 chr20 60008 61140   17   1133 0.8378468    FALSE</span></span>
<span><span class="co">## 2 chr20.61141 chr20 61141 61817   12    677 0.8450438    FALSE</span></span>
<span><span class="co">## 3 chr20.61818 chr20 61818 63862   18   2045 0.8514536    FALSE</span></span>
<span><span class="co">## 4 chr20.63863 chr20 63863 64424   13    562 0.8565943    FALSE</span></span>
<span><span class="co">## 5 chr20.64609 chr20 64609 64728    6    120 0.6418476    FALSE</span></span>
<span><span class="co">## 6 chr20.64778 chr20 64778 65365    6    588 0.1449167    FALSE</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">segment_result</span><span class="op">$</span><span class="va">betas_per_segment</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               Sample1   Sample2   Sample3    Sample4   Sample5    Sample6</span></span>
<span><span class="co">## chr20.60008 0.7331288 0.7795786 0.8133333 0.84156977 0.7853659 0.81250000</span></span>
<span><span class="co">## chr20.61141 0.8740920 0.7928571 0.8174157 0.86084906 0.8803612 0.89154013</span></span>
<span><span class="co">## chr20.61818 0.8943894 0.8278388 0.7691083 0.89508197 0.8259587 0.82819383</span></span>
<span><span class="co">## chr20.63863 0.8560748 0.8793103 0.8287154 0.87633262 0.7705628 0.81779661</span></span>
<span><span class="co">## chr20.64609 0.5810056 0.7909605 0.5865385 0.63636364 0.6150943 0.71794872</span></span>
<span><span class="co">## chr20.64778 0.2077922 0.1000000 0.2321429 0.02764977 0.0000000 0.07692308</span></span>
<span><span class="co">##               Sample7    Sample8   Sample9   Sample10  Sample11  Sample12</span></span>
<span><span class="co">## chr20.60008 0.8653251 0.89727127 0.9042357 0.81441718 0.7964169 0.8934911</span></span>
<span><span class="co">## chr20.61141 0.9152120 0.94017094 0.7426326 0.85650224 0.7752294 0.7946429</span></span>
<span><span class="co">## chr20.61818 0.8787313 0.77701544 0.8374291 0.83053691 0.8900145 0.8762376</span></span>
<span><span class="co">## chr20.63863 0.8160622 0.77941176 0.8909513 0.74315789 0.8958333 0.9621749</span></span>
<span><span class="co">## chr20.64609 0.6912442 0.69565217 0.7898551 0.51933702 0.6346154 0.6311111</span></span>
<span><span class="co">## chr20.64778 0.2844037 0.05769231 0.1984733 0.08024691 0.1188811 0.1530612</span></span>
<span><span class="co">##              Sample13   Sample14  Sample15  Sample16  Sample17   Sample18</span></span>
<span><span class="co">## chr20.60008 0.8477930 0.85780526 0.8138848 0.8699187 0.8298755 0.89660743</span></span>
<span><span class="co">## chr20.61141 0.9192140 0.91549296 0.8333333 0.8463357 0.8592965 0.78795812</span></span>
<span><span class="co">## chr20.61818 0.8681481 0.81139756 0.8013468 0.8629283 0.8820059 0.93140244</span></span>
<span><span class="co">## chr20.63863 0.8687783 0.83193277 0.8916479 0.9232614 0.8540434 0.80167015</span></span>
<span><span class="co">## chr20.64609 0.5294118 0.66666667 0.6567164 0.4928910 0.6908213 0.65024631</span></span>
<span><span class="co">## chr20.64778 0.1682692 0.05462185 0.2631579 0.1298077 0.2117117 0.05952381</span></span>
<span><span class="co">##              Sample19  Sample20</span></span>
<span><span class="co">## chr20.60008 0.7971014 0.9366603</span></span>
<span><span class="co">## chr20.61141 0.7953092 0.8556034</span></span>
<span><span class="co">## chr20.61818 0.9240924 0.8153619</span></span>
<span><span class="co">## chr20.63863 0.9120172 0.9628713</span></span>
<span><span class="co">## chr20.64609 0.6808511 0.6701031</span></span>
<span><span class="co">## chr20.64778 0.2166667 0.2110092</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">segment_result</span>, segments_to_plot <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">segment_result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">segment_result</span>, segments_to_plot <span class="op">=</span> <span class="fl">50</span><span class="op">:</span><span class="fl">60</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="768"></p>
</div>
<div class="section level2">
<h2 id="apply-fuse-through-separate-steps">Apply FUSE through separate steps<a class="anchor" aria-label="anchor" href="#apply-fuse-through-separate-steps"></a>
</h2>
<p>If the intermediate outputs of the method are relevant, then the
pipeline can also be applied by calling each of the functions
‘fuse.cluster()’, ‘number.of.clusters()’, ‘fuse.cut.tree()’, and
‘fuse.summary()’ separately.</p>
<div class="section level3">
<h3 id="cluster">1. Cluster<a class="anchor" aria-label="anchor" href="#cluster"></a>
</h3>
<p>In the first step, ‘fuse.cluster()’ is applied on the count matrices.
This performs a hierarchical clustering of closest neighbors, and
outputs a clustering tree.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fuse.cluster.html">fuse.cluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">K1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          m1     m2 logl_tot logl_merge genomic_dist</span></span>
<span><span class="co">## [1,] -45579 -45580 10.65993   10.65993      1.14483</span></span>
<span><span class="co">## [2,] -49658 -49659 12.57786   12.57786      1.14483</span></span>
<span><span class="co">## [3,] -57737 -57738 12.62932   12.62932      1.14483</span></span>
<span><span class="co">## [4,] -46190 -46191 12.70708   12.70708      1.14483</span></span>
<span><span class="co">## [5,] -23937 -23938 16.63625   16.63625      1.14483</span></span>
<span><span class="co">## [6,] -88318 -88319 16.75105   16.75105      1.14483</span></span></code></pre>
<p>The clustering ‘tree’ contains the following columns:</p>
<ul>
<li>‘m1’: the label of the first merged point</li>
<li>‘m2’: the label of the second merged point</li>
<li>‘logl_tot’: Change in total log-likelihood for forming this
merge</li>
<li>‘logl_merge’: Total cost of the points in this formed cluster</li>
<li>‘genomic_dist’: Distance penalty for this merge</li>
</ul>
</div>
<div class="section level3">
<h3 id="cutting-the-tree">2. Cutting the tree<a class="anchor" aria-label="anchor" href="#cutting-the-tree"></a>
</h3>
<p>In order to cut the clustering tree, the optimal number of segments
needs to be calculated. For this we have the function
‘number.of.clusters()’, which performs model selection by minimizing
either the Bayesian Information Criterion (BIC, default), or the Akaike
Information Criterion (AIC).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Need the total likelihood per model, which is sum of likelihood changes</span></span>
<span><span class="va">tree</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">tree</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">optimal_num_of_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/number.of.clusters.html">number.of.clusters</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span>, <span class="st">'BIC'</span><span class="op">)</span></span>
<span><span class="va">optimal_num_of_segments</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 9027</span></span></code></pre>
<p>The tree can then be cut using ‘fuse.cut.tree()’</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fuse.cut.tree.html">fuse.cut.tree</a></span><span class="op">(</span><span class="va">tree</span>, <span class="va">optimal_num_of_segments</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">segments</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3</span></span>
<span><span class="co">##  [38] 3 3 3 3 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 5 5 5 5 5 5 6 6 6 6 6 6 7 7</span></span>
<span><span class="co">##  [75] 7 7 7 7 7 7 7 7 7 7 8 8 8 8 8 8 8 8 8 8 8 8 8 8 9 9</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="summarizing-segments">3. Summarizing segments<a class="anchor" aria-label="anchor" href="#summarizing-segments"></a>
</h3>
<p>The segments can be summarized in a table with the function
‘fuse.summary()’.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fuse.summary.html">fuse.summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span>, </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">K1</span><span class="op">)</span>, </span>
<span>                       chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\..*$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                       pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.*\\."</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">K0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                       <span class="va">segments</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       Segment   Chr Start   End CpGs Length      Beta Coherent</span></span>
<span><span class="co">## 1 chr20.60008 chr20 60008 61140   17   1133 0.8378468    FALSE</span></span>
<span><span class="co">## 2 chr20.61141 chr20 61141 61817   12    677 0.8450438    FALSE</span></span>
<span><span class="co">## 3 chr20.61818 chr20 61818 63862   18   2045 0.8514536    FALSE</span></span>
<span><span class="co">## 4 chr20.63863 chr20 63863 64424   13    562 0.8565943    FALSE</span></span>
<span><span class="co">## 5 chr20.64609 chr20 64609 64728    6    120 0.6418476    FALSE</span></span>
<span><span class="co">## 6 chr20.64778 chr20 64778 65365    6    588 0.1449167    FALSE</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">betas_per_segment</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               Sample1   Sample2   Sample3    Sample4   Sample5    Sample6</span></span>
<span><span class="co">## chr20.60008 0.7331288 0.7795786 0.8133333 0.84156977 0.7853659 0.81250000</span></span>
<span><span class="co">## chr20.61141 0.8740920 0.7928571 0.8174157 0.86084906 0.8803612 0.89154013</span></span>
<span><span class="co">## chr20.61818 0.8943894 0.8278388 0.7691083 0.89508197 0.8259587 0.82819383</span></span>
<span><span class="co">## chr20.63863 0.8560748 0.8793103 0.8287154 0.87633262 0.7705628 0.81779661</span></span>
<span><span class="co">## chr20.64609 0.5810056 0.7909605 0.5865385 0.63636364 0.6150943 0.71794872</span></span>
<span><span class="co">## chr20.64778 0.2077922 0.1000000 0.2321429 0.02764977 0.0000000 0.07692308</span></span>
<span><span class="co">##               Sample7    Sample8   Sample9   Sample10  Sample11  Sample12</span></span>
<span><span class="co">## chr20.60008 0.8653251 0.89727127 0.9042357 0.81441718 0.7964169 0.8934911</span></span>
<span><span class="co">## chr20.61141 0.9152120 0.94017094 0.7426326 0.85650224 0.7752294 0.7946429</span></span>
<span><span class="co">## chr20.61818 0.8787313 0.77701544 0.8374291 0.83053691 0.8900145 0.8762376</span></span>
<span><span class="co">## chr20.63863 0.8160622 0.77941176 0.8909513 0.74315789 0.8958333 0.9621749</span></span>
<span><span class="co">## chr20.64609 0.6912442 0.69565217 0.7898551 0.51933702 0.6346154 0.6311111</span></span>
<span><span class="co">## chr20.64778 0.2844037 0.05769231 0.1984733 0.08024691 0.1188811 0.1530612</span></span>
<span><span class="co">##              Sample13   Sample14  Sample15  Sample16  Sample17   Sample18</span></span>
<span><span class="co">## chr20.60008 0.8477930 0.85780526 0.8138848 0.8699187 0.8298755 0.89660743</span></span>
<span><span class="co">## chr20.61141 0.9192140 0.91549296 0.8333333 0.8463357 0.8592965 0.78795812</span></span>
<span><span class="co">## chr20.61818 0.8681481 0.81139756 0.8013468 0.8629283 0.8820059 0.93140244</span></span>
<span><span class="co">## chr20.63863 0.8687783 0.83193277 0.8916479 0.9232614 0.8540434 0.80167015</span></span>
<span><span class="co">## chr20.64609 0.5294118 0.66666667 0.6567164 0.4928910 0.6908213 0.65024631</span></span>
<span><span class="co">## chr20.64778 0.1682692 0.05462185 0.2631579 0.1298077 0.2117117 0.05952381</span></span>
<span><span class="co">##              Sample19  Sample20</span></span>
<span><span class="co">## chr20.60008 0.7971014 0.9366603</span></span>
<span><span class="co">## chr20.61141 0.7953092 0.8556034</span></span>
<span><span class="co">## chr20.61818 0.9240924 0.8153619</span></span>
<span><span class="co">## chr20.63863 0.9120172 0.9628713</span></span>
<span><span class="co">## chr20.64609 0.6808511 0.6701031</span></span>
<span><span class="co">## chr20.64778 0.2166667 0.2110092</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="verification">Verification<a class="anchor" aria-label="anchor" href="#verification"></a>
</h3>
<p>The outputs are identical.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">segment_result</span><span class="op">$</span><span class="va">summary</span>, <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">segment_result</span><span class="op">$</span><span class="va">betas_per_segment</span>, <span class="va">result</span><span class="op">$</span><span class="va">betas_per_segment</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>Let’s visualize a small piece of the result:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, segments_to_plot <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" alt="" width="768"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Susanna Holmström.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
